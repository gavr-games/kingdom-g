import { EventBus } from "@/lib/event_bus";
import Game from "./game";
import boardConfig from "./board/config";

class GameController {
  constructor() {
    this.game = new Game();
  }

  init() {
    let dummyGameJson = {"turn-order":[0,1],"objects":{"0":{"rotation":0,"flip":0,"coords":{"[0 0]":{"fill":"solid"},"[0 1]":{"fill":"solid"},"[1 0]":{"fill":"solid"},"[1 1]":{"fill":"floor","spawn":true}},"type":"castle","max-health":10,"handlers":{"before-destruction":["castle-destroyed"]},"class":"building","health":10,"position":[0,0],"player":0},"1":{"moves":2,"coords":{"[0 0]":{"fill":"unit"}},"max-moves":2,"type":"spearman","max-health":1,"actions":["move","levelup","attack"],"class":"unit","health":1,"position":[2,0],"player":0,"attack":1},"2":{"moves":2,"coords":{"[0 0]":{"fill":"unit"}},"max-moves":2,"type":"spearman","max-health":1,"actions":["move","levelup","attack"],"class":"unit","health":1,"position":[0,2],"player":0,"attack":1},"3":{"rotation":2,"flip":0,"coords":{"[0 0]":{"fill":"solid"},"[0 1]":{"fill":"solid"},"[1 0]":{"fill":"solid"},"[1 1]":{"fill":"floor","spawn":true}},"type":"castle","max-health":10,"handlers":{"before-destruction":["castle-destroyed"]},"class":"building","health":10,"position":[19,19],"player":2},"4":{"moves":0,"coords":{"[0 0]":{"fill":"unit"}},"max-moves":2,"type":"spearman","max-health":1,"actions":["move","levelup","attack"],"class":"unit","health":1,"position":[19,17],"player":2,"attack":1},"5":{"moves":0,"coords":{"[0 0]":{"fill":"unit"}},"max-moves":2,"type":"spearman","max-health":1,"actions":["move","levelup","attack"],"class":"unit","health":1,"position":[17,19],"player":2,"attack":1}},"actions":[],"last-added-object-id":5,"commands":[{"command":"add-object","object-id":0,"action-id":-1},{"command":"add-object","object-id":1,"action-id":-1},{"command":"add-object","object-id":2,"action-id":-1},{"command":"add-object","object-id":3,"action-id":-1},{"command":"add-object","object-id":4,"action-id":-1},{"command":"add-object","object-id":5,"action-id":-1},{"command":"set-moves","object-id":1,"moves":2,"action-id":-1},{"command":"set-moves","object-id":2,"moves":2,"action-id":-1},{"command":"set-active-player","player":0,"action-id":-1}],"active-player":0,"status":"active","players":{"0":{"gold":100,"team":0,"status":"active","main-object":0},"1":{"gold":100,"team":1,"status":"active","main-object":3}},"last-added-player":1,"board":{"[8 8]":{},"[7 6]":{},"[8 7]":{},"[16 6]":{},"[3 15]":{},"[8 11]":{},"[16 19]":{},"[9 8]":{},"[7 1]":{},"[10 14]":{},"[5 19]":{},"[12 12]":{},"[8 9]":{},"[7 12]":{},"[2 18]":{},"[8 18]":{},"[12 18]":{},"[12 6]":{},"[15 4]":{},"[13 3]":{},"[10 5]":{},"[13 15]":{},"[15 11]":{},"[11 9]":{},"[11 2]":{},"[4 3]":{},"[7 11]":{},"[17 5]":{},"[19 6]":{},"[2 2]":{},"[12 17]":{},"[7 13]":{},"[18 12]":{},"[19 16]":{},"[0 0]":{"0":{"fill":"solid"}},"[9 18]":{},"[3 9]":{},"[13 8]":{},"[4 12]":{},"[7 7]":{},"[18 3]":{},"[2 8]":{},"[3 19]":{},"[10 15]":{},"[13 6]":{},"[14 17]":{},"[17 2]":{},"[1 0]":{"0":{"fill":"solid"}},"[19 9]":{},"[8 4]":{},"[17 6]":{},"[2 3]":{},"[18 7]":{},"[2 5]":{},"[7 2]":{},"[16 5]":{},"[15 16]":{},"[10 13]":{},"[15 17]":{},"[18 0]":{},"[15 19]":{},"[6 7]":{},"[15 0]":{},"[12 13]":{},"[15 12]":{},"[12 14]":{},"[7 4]":{},"[8 3]":{},"[9 15]":{},"[0 6]":{},"[3 3]":{},"[6 19]":{},"[13 12]":{},"[10 9]":{},"[5 4]":{},"[0 19]":{},"[3 16]":{},"[15 3]":{},"[10 8]":{},"[5 10]":{},"[18 2]":{},"[1 1]":{"0":{"fill":"floor","spawn":true}},"[6 3]":{},"[7 18]":{},"[17 16]":{},"[0 5]":{},"[14 6]":{},"[3 4]":{},"[17 18]":{},"[2 19]":{},"[11 14]":{},"[11 0]":{},"[17 0]":{},"[12 8]":{},"[1 12]":{},"[9 19]":{},"[12 5]":{},"[7 3]":{},"[19 12]":{},"[8 6]":{},"[12 2]":{},"[16 7]":{},"[17 12]":{},"[1 15]":{},"[15 9]":{},"[17 1]":{},"[4 2]":{},"[14 13]":{},"[0 18]":{},"[18 19]":{"3":{"fill":"solid"}},"[7 8]":{},"[9 16]":{},"[3 12]":{},"[4 14]":{},"[13 2]":{},"[18 10]":{},"[3 0]":{},"[10 17]":{},"[18 18]":{"3":{"fill":"floor","spawn":true}},"[9 0]":{},"[6 6]":{},"[9 6]":{},"[1 13]":{},"[12 1]":{},"[11 13]":{},"[13 9]":{},"[19 10]":{},"[6 13]":{},"[16 2]":{},"[1 9]":{},"[18 11]":{},"[0 13]":{},"[11 18]":{},"[8 10]":{},"[14 19]":{},"[5 3]":{},"[18 4]":{},"[18 14]":{},"[9 9]":{},"[10 19]":{},"[13 7]":{},"[9 3]":{},"[0 17]":{},"[9 12]":{},"[4 7]":{},"[13 1]":{},"[4 10]":{},"[4 15]":{},"[19 7]":{},"[0 15]":{},"[0 14]":{},"[3 13]":{},"[4 9]":{},"[1 10]":{},"[2 9]":{},"[18 9]":{},"[6 5]":{},"[11 11]":{},"[5 13]":{},"[13 0]":{},"[8 19]":{},"[3 17]":{},"[5 14]":{},"[16 13]":{},"[19 1]":{},"[4 11]":{},"[18 6]":{},"[5 16]":{},"[0 9]":{},"[8 0]":{},"[4 1]":{},"[5 2]":{},"[2 13]":{},"[16 3]":{},"[4 6]":{},"[14 15]":{},"[15 7]":{},"[17 4]":{},"[16 8]":{},"[11 4]":{},"[1 4]":{},"[10 2]":{},"[11 8]":{},"[1 11]":{},"[5 7]":{},"[11 12]":{},"[10 16]":{},"[16 16]":{},"[12 7]":{},"[12 0]":{},"[8 2]":{},"[4 18]":{},"[16 0]":{},"[10 7]":{},"[10 0]":{},"[11 10]":{},"[1 3]":{},"[4 19]":{},"[4 8]":{},"[10 11]":{},"[18 1]":{},"[12 11]":{},"[15 1]":{},"[1 5]":{},"[9 14]":{},"[13 13]":{},"[12 10]":{},"[11 6]":{},"[14 4]":{},"[11 3]":{},"[15 10]":{},"[1 8]":{},"[8 16]":{},"[1 7]":{},"[12 4]":{},"[16 17]":{},"[11 19]":{},"[15 18]":{},"[6 4]":{},"[15 5]":{},"[18 8]":{},"[19 19]":{"3":{"fill":"solid"}},"[18 17]":{},"[1 18]":{},"[8 1]":{},"[2 12]":{},"[16 11]":{},"[19 4]":{},"[14 8]":{},"[18 16]":{},"[0 3]":{},"[5 1]":{},"[6 1]":{},"[2 11]":{},"[6 14]":{},"[5 11]":{},"[1 16]":{},"[5 6]":{},"[5 8]":{},"[16 18]":{},"[2 15]":{},"[13 19]":{},"[13 11]":{},"[8 15]":{},"[6 18]":{},"[8 13]":{},"[8 5]":{},"[0 7]":{},"[4 17]":{},"[3 18]":{},"[9 17]":{},"[14 11]":{},"[15 8]":{},"[6 8]":{},"[13 5]":{},"[9 11]":{},"[6 11]":{},"[10 1]":{},"[5 5]":{},"[7 9]":{},"[10 12]":{},"[14 1]":{},"[2 7]":{},"[11 1]":{},"[5 17]":{},"[2 17]":{},"[13 17]":{},"[15 6]":{},"[5 9]":{},"[2 4]":{},"[3 6]":{},"[19 14]":{},"[5 15]":{},"[6 15]":{},"[12 15]":{},"[14 5]":{},"[7 10]":{},"[19 13]":{},"[17 3]":{},"[10 6]":{},"[17 14]":{},"[17 10]":{},"[9 2]":{},"[19 5]":{},"[0 12]":{},"[4 5]":{},"[11 7]":{},"[9 1]":{},"[9 7]":{},"[10 4]":{},"[17 15]":{},"[15 13]":{},"[10 10]":{},"[7 0]":{},"[0 16]":{},"[12 9]":{},"[0 2]":{"2":{"fill":"unit"}},"[19 11]":{},"[6 9]":{},"[19 3]":{},"[17 11]":{},"[11 15]":{},"[4 16]":{},"[3 14]":{},"[16 12]":{},"[2 0]":{"1":{"fill":"unit"}},"[0 4]":{},"[3 11]":{},"[10 18]":{},"[14 18]":{},"[0 10]":{},"[19 0]":{},"[11 5]":{},"[19 18]":{"3":{"fill":"solid"}},"[9 13]":{},"[3 1]":{},"[19 15]":{},"[3 10]":{},"[12 3]":{},"[16 14]":{},"[13 16]":{},"[17 13]":{},"[14 14]":{},"[1 17]":{},"[2 1]":{},"[6 17]":{},"[19 8]":{},"[1 14]":{},"[9 5]":{},"[13 18]":{},"[6 10]":{},"[3 8]":{},"[9 4]":{},"[18 15]":{},"[12 19]":{},"[7 14]":{},"[14 2]":{},"[0 11]":{},"[6 12]":{},"[16 1]":{},"[14 16]":{},"[16 15]":{},"[4 13]":{},"[1 6]":{},"[2 14]":{},"[16 9]":{},"[17 19]":{"5":{"fill":"unit"}},"[14 3]":{},"[4 4]":{},"[11 17]":{},"[7 16]":{},"[3 7]":{},"[2 10]":{},"[7 5]":{},"[7 15]":{},"[13 10]":{},"[2 6]":{},"[16 10]":{},"[5 0]":{},"[6 2]":{},"[14 12]":{},"[17 9]":{},"[9 10]":{},"[8 14]":{},"[8 12]":{},"[13 4]":{},"[6 0]":{},"[7 17]":{},"[16 4]":{},"[15 15]":{},"[12 16]":{},"[14 7]":{},"[1 2]":{},"[14 10]":{},"[6 16]":{},"[7 19]":{},"[5 18]":{},"[15 14]":{},"[2 16]":{},"[19 17]":{"4":{"fill":"unit"}},"[10 3]":{},"[18 13]":{},"[3 5]":{},"[13 14]":{},"[0 8]":{},"[5 12]":{},"[3 2]":{},"[17 8]":{},"[19 2]":{},"[14 9]":{},"[18 5]":{},"[11 16]":{},"[17 17]":{},"[14 0]":{},"[0 1]":{"0":{"fill":"solid"}},"[1 19]":{},"[15 2]":{},"[8 17]":{},"[4 0]":{},"[17 7]":{}}}
    EventBus.$emit("init-game", dummyGameJson);
  }

  enterFullscreen() {
    this.game.engine.enterFullscreen();
  }

  moveUnit(unit, cell) {
    let coords = {
      x: cell.mesh.position.x + boardConfig.cellSize / 2,
      z: cell.mesh.position.z - boardConfig.cellSize / 2,
      y: 0
    };
    unit.moveToCoords(coords);
    EventBus.$emit("unit-moved", unit, cell);
  }
}
const gameController = new GameController();

export default gameController;
